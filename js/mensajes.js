// ============================================
// BASE DE DATOS DE MENSAJES PARA TARJETAS
// DETALLES LAUREL MEDELLÍN
// ============================================

const mensajesTarjetas = {
    cumpleanos: [
        {
            titulo: "Feliz Cumpleaños",
            mensaje: "Que este nuevo año de vida esté lleno de momentos maravillosos, sueños cumplidos y mucha felicidad. ¡Feliz cumpleaños! 🎂"
        },
        {
            titulo: "Para una Princesa",
            mensaje: "Hoy celebramos el cumpleaños de una persona especial. Que todos tus deseos se hagan realidad. ¡Disfruta tu día! ✨"
        },
        {
            titulo: "15 Años Mágicos",
            mensaje: "Felicitaciones en tus 15 años. Que esta etapa esté llena de aventuras, sueños y momentos inolvidables. ¡Celebra con alegría! 🎉"
        },
        {
            titulo: "Siempre Joven",
            mensaje: "Los años no importan cuando tienes un corazón joven. Que este cumpleaños sea el inicio de nuevos sueños. ¡Felicidades! 🎈"
        },
        {
            titulo: "Cumpleaños Especial",
            mensaje: "Eres una persona única y especial. Que todos tus sueños se cumplan en este nuevo año. ¡Feliz cumpleaños! 🌟"
        },
        {
            titulo: "Muchas Bendiciones",
            mensaje: "Que este cumpleaños venga cargado de bendiciones, alegrías y momentos especiales. Que todos tus días estén llenos de felicidad. 🙏"
        },
        {
            titulo: "Año de Éxitos",
            mensaje: "Que este nuevo año de vida sea el mejor hasta ahora, lleno de logros, alegrías y éxito en todo lo que emprendas. ¡Feliz cumpleaños! 💪"
        },
        {
            titulo: "Día Único",
            mensaje: "Este es tu día especial. Disfrútalo al máximo con las personas que amas. ¡Que sea un cumpleaños inolvidable! 🎁"
        }
    ],

    amor: [
        {
            titulo: "Mi Amor Eterno",
            mensaje: "Cada día a tu lado es un regalo. Eres mi persona favorita y mi razón para sonreír. Te amo infinitamente. ❤️"
        },
        {
            titulo: "Con Todo Mi Amor",
            mensaje: "No hay palabras suficientes para expresar lo que siento por ti. Eres mi todo y quiero que lo sepas siempre. 💕"
        },
        {
            titulo: "Para Ti, Amor Mío",
            mensaje: "Eres la luz de mis días y la razón de mi felicidad. Gracias por ser mi todo. Te amo más de lo que puedo expresar. 💖"
        },
        {
            titulo: "Aniversario de Amor",
            mensaje: "Cada día junto a ti es una aventura. Gracias por estos años de amor, risas y momentos inolvidables. Te amo. 💑"
        },
        {
            titulo: "Mi Corazón Te Pertenece",
            mensaje: "Desde que llegaste a mi vida, todo tiene sentido. Eres el amor de mi vida y te amo con todo mi ser. 💝"
        },
        {
            titulo: "Eres Mi Razón",
            mensaje: "Amar es compartir la vida con la persona correcta, y tú eres esa persona. Te amo hoy y siempre. 💏"
        },
        {
            titulo: "Para Mi Media Naranja",
            mensaje: "No puedo imaginar mi vida sin ti. Eres mi complemento perfecto. Te amo con toda mi alma. 🧡"
        },
        {
            titulo: "Amor Verdadero",
            mensaje: "El amor verdadero es contigo. Gracias por ser la persona más especial de mi vida. Te amo infinitamente. 💗"
        },
        {
            titulo: "Mi Todo",
            mensaje: "Eres mi sol, mi luna y todas mis estrellas. No puedo concebir la vida sin ti. Te amo. 🌟"
        },
        {
            titulo: "Disculpa de Corazón",
            mensaje: "Sé que he cometido errores. Pero quiero que sepas que te amo y lamento profundamente. Perdóname. 💔"
        }
    ],

    amistad: [
        {
            titulo: "Mejor Amigo",
            mensaje: "Gracias por estar siempre ahí, por tus risas, por tu apoyo incondicional. Eres un amigo invaluable. ¡Te quiero mucho! 👯"
        },
        {
            titulo: "Siempre Juntos",
            mensaje: "Los verdaderos amigos son difíciles de encontrar. Gracias por ser uno de ellos. Tu amistad es un tesoro. 🤝"
        },
        {
            titulo: "Amigo Especial",
            mensaje: "Tenerte como amigo es una de las mejores cosas que me ha pasado en la vida. Gracias por todo. 🫂"
        },
        {
            titulo: "Agradézcele a un Amigo",
            mensaje: "Quería agradecerte por ser tan especial. Tu amistad es importante para mí. Gracias por estar siempre. 🙏"
        },
        {
            titulo: "Apoyo en Momentos Difíciles",
            mensaje: "Sé que estás pasando por un momento difícil. Quiero que sepas que estoy aquí para ti. Cuenta conmigo siempre. 💪"
        },
        {
            titulo: "Siempre Contigo",
            mensaje: "No importa lo que pase, siempre estaré aquí para ti. Eres un amigo increíble y valioso. Gracias. 🤗"
        },
        {
            titulo: "Celebración de Amistad",
            mensaje: "Hoy celebramos nuestra amistad. Gracias por todos los buenos momentos y por ser quien eres. ¡Te quiero mucho! 🎉"
        },
        {
            titulo: "Amigo de Corazón",
            mensaje: "Los verdaderos amigos no cuentan los días. Gracias por ser mi amigo de corazón. Valioso eres para mí. 💙"
        }
    ],

    familia: [
        {
            titulo: "Para Mamá",
            mensaje: "Mamá, gracias por tanto amor, por tu dedicación y por ser el mejor ejemplo. Te amo con todo mi corazón. 👩"
        },
        {
            titulo: "Para Papá",
            mensaje: "Papá, eres mi héroe, mi guía y mi mejor amigo. Gracias por todo lo que has hecho por mí. Con cariño. 👨"
        },
        {
            titulo: "Día de la Madre",
            mensaje: "Mamá, eres la mujer más fuerte y amorosa que conozco. Gracias por ser mi apoyo incondicional. Te amo. 💐"
        },
        {
            titulo: "Día del Padre",
            mensaje: "Papá, gracias por tus enseñanzas, tu amor y tu ejemplo. Eres el mejor padre del mundo. Te amo. 👔"
        },
        {
            titulo: "Felicitaciones Graduación",
            mensaje: "¡Felicidades por tu graduación! Todo tu esfuerzo ha valido la pena. Estamos orgullosos de ti. ¡Éxitos! 🎓"
        },
        {
            titulo: "Baby Shower",
            mensaje: "Felicitaciones por esta hermosa noticia. Que el bebé llegue con salud y llene su hogar de alegría. 👶"
        },
        {
            titulo: "Bienvenida Bebé",
            mensaje: "Bienvenido/a a este mundo. Que seas feliz y que traigas mucha alegría a tu familia. ¡Felicidades! 🌟"
        },
        {
            titulo: "Día de la Mujer",
            mensaje: "Gracias por ser tan especial. Celebra con orgullo todo lo que eres. ¡Feliz Día de la Mujer! 💃"
        },
        {
            titulo: "Para Mi Hermana",
            mensaje: "Hermana, gracias por ser mi compañera de vida. Te amo y te admiro. Eres especial. 💕"
        },
        {
            titulo: "Para Mi Hermano",
            mensaje: "Hermano, eres el mejor. Gracias por estar siempre y por ser quien eres. Te quiero mucho. 💙"
        }
    ],

    especiales: [
        {
            titulo: "Feliz Navidad",
            mensaje: "Que esta Navidad traiga paz, amor y muchas bendiciones a tu hogar. ¡Feliz Navidad! 🎄"
        },
        {
            titulo: "Próximo Matrimonio",
            mensaje: "Felicitaciones en este nuevo paso juntos. Que este día sea solo el inicio de una hermosa historia llena de amor. 💍"
        },
        {
            titulo: "Feliz Año Nuevo",
            mensaje: "Que este nuevo año traiga bendiciones, éxitos y momentos inolvidables. ¡Feliz Año Nuevo! 🎊"
        },
        {
            titulo: "Día de Acción de Gracias",
            mensaje: "Hoy damos gracias por tener personas como tú en nuestras vidas. ¡Feliz Día de Acción de Gracias! 🦃"
        },
        {
            titulo: "Bienvenida Casa Nueva",
            mensaje: "Felicitaciones por tu nuevo hogar. Que sea el lugar donde se construyan hermosos recuerdos y mucha felicidad. 🏠"
        },
        {
            titulo: "Nuevo Trabajo",
            mensaje: "Felicidades por tu nuevo trabajo. Que sea el inicio de grandes logros y éxitos profesionales. 💼"
        },
        {
            titulo: "Recuperación Rápida",
            mensaje: "Esperamos tu pronta recuperación. Descansa y cuídate. Estamos pensando en ti. ¡Ánimo! 💪"
        },
        {
            titulo: "Día Especial",
            mensaje: "Sabemos que hoy es un día especial para ti. Esperamos que lo celebres rodeado de las personas que amas. ¡Felicidades! 🎉"
        },
        {
            titulo: "Logro Alcanzado",
            mensaje: "Felicidades por tu logro. Sabemos que has trabajado duro para alcanzarlo. ¡Sigue así! 🌟"
        },
        {
            titulo: "Motivación",
            mensaje: "Sabemos que puedes lograrlo. Tienes toda nuestra confianza y apoyo. ¡Vamos, tú puedes! 💪"
        }
    ]
};

// Función para obtener todos los mensajes mezclados
function getAllMessages() {
    return [
        ...mensajesTarjetas.cumpleanos,
        ...mensajesTarjetas.amor,
        ...mensajesTarjetas.amistad,
        ...mensajesTarjetas.familia,
        ...mensajesTarjetas.especiales
    ];
}

// Variables globales para paginación
let mensajesActuales = [];
let paginaActual = 1;
let mensajesPorPagina = 10;

// Función para filtrar y mostrar mensajes
function filtrarMensajes(ocasion) {
    const contenedor = document.querySelector('.mensajes-grid');
    const paginacionContainer = document.getElementById('mensajesPagination');
    
    mensajesActuales = ocasion === 'todas' ? getAllMessages() : mensajesTarjetas[ocasion];
    paginaActual = 1; // Resetear a la primera página
    
    if (!contenedor) {
        console.error('Contenedor de mensajes no encontrado');
        return;
    }

    if (!mensajesActuales || mensajesActuales.length === 0) {
        contenedor.innerHTML = '<p style="text-align: center; grid-column: 1/-1; color: var(--text-color);">No hay mensajes disponibles para esta categoría.</p>';
        paginacionContainer.innerHTML = '';
        return;
    }

    mostrarMensajesPagina();
    mostrarPaginacion();
}

// Función para mostrar mensajes de la página actual
function mostrarMensajesPagina() {
    const contenedor = document.querySelector('.mensajes-grid');
    const inicio = (paginaActual - 1) * mensajesPorPagina;
    const fin = inicio + mensajesPorPagina;
    const mensajesPagina = mensajesActuales.slice(inicio, fin);
    
    contenedor.innerHTML = mensajesPagina.map((msg, index) => `
        <div class="mensaje-card">
            <h3 class="mensaje-titulo">${msg.titulo}</h3>
            <p class="mensaje-texto">${msg.mensaje}</p>
            <div class="mensaje-acciones">
                <button class="btn-copiar" onclick="copiarMensaje('${msg.titulo.replace(/'/g, "\\'")}', '${msg.mensaje.replace(/'/g, "\\'")}', ${inicio + index})">
                    📋 Copiar
                </button>
            </div>
        </div>
    `).join('');
}

// Función para mostrar controles de paginación
function mostrarPaginacion() {
    const paginacionContainer = document.getElementById('mensajesPagination');
    const totalPaginas = Math.ceil(mensajesActuales.length / mensajesPorPagina);
    
    if (totalPaginas <= 1) {
        paginacionContainer.innerHTML = '';
        return;
    }
    
    paginacionContainer.innerHTML = '';
    
    // Configuración para mostrar 5 páginas en escritorio y 3 en móvil
    const isMobile = window.innerWidth <= 768;
    const maxVisiblePages = isMobile ? 3 : 5;
    let startPage = Math.max(1, paginaActual - Math.floor(maxVisiblePages / 2));
    let endPage = Math.min(totalPaginas, startPage + maxVisiblePages - 1);
    
    // Ajustar startPage si estamos cerca del final
    if (endPage - startPage < maxVisiblePages - 1) {
        startPage = Math.max(1, endPage - maxVisiblePages + 1);
    }

    // Botón "Primera página" si no estamos en la primera
    if (paginaActual > 1) {
        const firstButton = document.createElement('button');
        firstButton.textContent = '«';
        firstButton.title = 'Primera página';
        firstButton.addEventListener('click', () => cambiarPagina(1));
        paginacionContainer.appendChild(firstButton);
    }

    // Botón "Anterior" si no estamos en la primera página
    if (paginaActual > 1) {
        const prevButton = document.createElement('button');
        prevButton.textContent = '‹';
        prevButton.title = 'Página anterior';
        prevButton.addEventListener('click', () => cambiarPagina(paginaActual - 1));
        paginacionContainer.appendChild(prevButton);
    }

    // Botones de páginas
    for (let i = startPage; i <= endPage; i++) {
        const pageButton = document.createElement('button');
        pageButton.textContent = i;
        if (i === paginaActual) {
            pageButton.classList.add('active');
        }
        pageButton.addEventListener('click', () => cambiarPagina(i));
        paginacionContainer.appendChild(pageButton);
    }

    // Botón "Siguiente" si no estamos en la última página
    if (paginaActual < totalPaginas) {
        const nextButton = document.createElement('button');
        nextButton.textContent = '›';
        nextButton.title = 'Página siguiente';
        nextButton.addEventListener('click', () => cambiarPagina(paginaActual + 1));
        paginacionContainer.appendChild(nextButton);
    }

    // Botón "Última página" si no estamos en la última
    if (paginaActual < totalPaginas) {
        const lastButton = document.createElement('button');
        lastButton.textContent = '»';
        lastButton.title = 'Última página';
        lastButton.addEventListener('click', () => cambiarPagina(totalPaginas));
        paginacionContainer.appendChild(lastButton);
    }
}

// Función para cambiar de página
function cambiarPagina(nuevaPagina) {
    const totalPaginas = Math.ceil(mensajesActuales.length / mensajesPorPagina);
    
    if (nuevaPagina >= 1 && nuevaPagina <= totalPaginas) {
        paginaActual = nuevaPagina;
        mostrarMensajesPagina();
        mostrarPaginacion();
        
        // Scroll suave hacia la sección de mensajes
        document.getElementById('mensajes-tarjetas').scrollIntoView({ 
            behavior: 'smooth', 
            block: 'start' 
        });
    }
}

// Función para copiar mensaje al portapapeles
function copiarMensaje(titulo, mensaje, index) {
    // Crear el texto completo con el título en negrita
    const textoCompleto = `${titulo}\n\n${mensaje}`;
    
    // Crear un elemento temporal para copiar el texto
    const tempElement = document.createElement('textarea');
    tempElement.value = textoCompleto;
    tempElement.style.position = 'fixed';
    tempElement.style.opacity = '0';
    document.body.appendChild(tempElement);
    tempElement.select();
    
    try {
        document.execCommand('copy');
        showCopiedBanner();
    } catch (err) {
        console.error('Error al copiar:', err);
    } finally {
        document.body.removeChild(tempElement);
    }
}

// Función para mostrar banner de "copiado"
function showCopiedBanner() {
    const banner = document.getElementById('copiarBanner');
    if (banner) {
        banner.style.display = 'block';
        setTimeout(() => {
            banner.style.display = 'none';
        }, 3000);
    }
}

// Inicializar sistema de mensajes cuando el DOM esté listo
document.addEventListener('DOMContentLoaded', function() {
    // Cargar mensajes de todas las categorías por defecto
    filtrarMensajes('todas');

    // Inicializar Select2 para todas las resoluciones
    const select2Ocasiones = $('#ocasiones-select2');
    if (select2Ocasiones.length) {
        select2Ocasiones.select2({
            placeholder: 'Buscar o seleccionar ocasiones...',
            allowClear: true,
            width: '100%'
        });

        select2Ocasiones.on('change', function() {
            const valores = $(this).val();
            // Si no hay selecciones, mostrar todas las categorías
            if (!valores || valores.length === 0) {
                filtrarMensajes('todas');
            } else {
                // Filtrar por la primera categoría seleccionada
                filtrarMensajes(valores[0]);
            }
        });
    }

    // Redibujar paginación cuando cambie el tamaño de la ventana
    window.addEventListener('resize', function() {
        if (mensajesActuales.length > 0) {
            mostrarPaginacion();
        }
    });

    console.log('✅ Sistema de mensajes para tarjetas inicializado');
});

