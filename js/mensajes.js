// ============================================
// BASE DE DATOS DE MENSAJES PARA TARJETAS
// DETALLES LAUREL MEDELLÃN
// ============================================

const mensajesTarjetas = {
    cumpleanos: [
        {
            titulo: "Feliz CumpleaÃ±os",
            mensaje: "Que este nuevo aÃ±o de vida estÃ© lleno de momentos maravillosos, sueÃ±os cumplidos y mucha felicidad. Â¡Feliz cumpleaÃ±os! ğŸ‚"
        },
        {
            titulo: "Para una Princesa",
            mensaje: "Hoy celebramos el cumpleaÃ±os de una persona especial. Que todos tus deseos se hagan realidad. Â¡Disfruta tu dÃ­a! âœ¨"
        },
        {
            titulo: "15 AÃ±os MÃ¡gicos",
            mensaje: "Felicitaciones en tus 15 aÃ±os. Que esta etapa estÃ© llena de aventuras, sueÃ±os y momentos inolvidables. Â¡Celebra con alegrÃ­a! ğŸ‰"
        },
        {
            titulo: "Siempre Joven",
            mensaje: "Los aÃ±os no importan cuando tienes un corazÃ³n joven. Que este cumpleaÃ±os sea el inicio de nuevos sueÃ±os. Â¡Felicidades! ğŸˆ"
        },
        {
            titulo: "CumpleaÃ±os Especial",
            mensaje: "Eres una persona Ãºnica y especial. Que todos tus sueÃ±os se cumplan en este nuevo aÃ±o. Â¡Feliz cumpleaÃ±os! ğŸŒŸ"
        },
        {
            titulo: "Muchas Bendiciones",
            mensaje: "Que este cumpleaÃ±os venga cargado de bendiciones, alegrÃ­as y momentos especiales. Que todos tus dÃ­as estÃ©n llenos de felicidad. ğŸ™"
        },
        {
            titulo: "AÃ±o de Ã‰xitos",
            mensaje: "Que este nuevo aÃ±o de vida sea el mejor hasta ahora, lleno de logros, alegrÃ­as y Ã©xito en todo lo que emprendas. Â¡Feliz cumpleaÃ±os! ğŸ’ª"
        },
        {
            titulo: "DÃ­a Ãšnico",
            mensaje: "Este es tu dÃ­a especial. DisfrÃºtalo al mÃ¡ximo con las personas que amas. Â¡Que sea un cumpleaÃ±os inolvidable! ğŸ"
        }
    ],

    amor: [
        {
            titulo: "Mi Amor Eterno",
            mensaje: "Cada dÃ­a a tu lado es un regalo. Eres mi persona favorita y mi razÃ³n para sonreÃ­r. Te amo infinitamente. â¤ï¸"
        },
        {
            titulo: "Con Todo Mi Amor",
            mensaje: "No hay palabras suficientes para expresar lo que siento por ti. Eres mi todo y quiero que lo sepas siempre. ğŸ’•"
        },
        {
            titulo: "Para Ti, Amor MÃ­o",
            mensaje: "Eres la luz de mis dÃ­as y la razÃ³n de mi felicidad. Gracias por ser mi todo. Te amo mÃ¡s de lo que puedo expresar. ğŸ’–"
        },
        {
            titulo: "Aniversario de Amor",
            mensaje: "Cada dÃ­a junto a ti es una aventura. Gracias por estos aÃ±os de amor, risas y momentos inolvidables. Te amo. ğŸ’‘"
        },
        {
            titulo: "Mi CorazÃ³n Te Pertenece",
            mensaje: "Desde que llegaste a mi vida, todo tiene sentido. Eres el amor de mi vida y te amo con todo mi ser. ğŸ’"
        },
        {
            titulo: "Eres Mi RazÃ³n",
            mensaje: "Amar es compartir la vida con la persona correcta, y tÃº eres esa persona. Te amo hoy y siempre. ğŸ’"
        },
        {
            titulo: "Para Mi Media Naranja",
            mensaje: "No puedo imaginar mi vida sin ti. Eres mi complemento perfecto. Te amo con toda mi alma. ğŸ§¡"
        },
        {
            titulo: "Amor Verdadero",
            mensaje: "El amor verdadero es contigo. Gracias por ser la persona mÃ¡s especial de mi vida. Te amo infinitamente. ğŸ’—"
        },
        {
            titulo: "Mi Todo",
            mensaje: "Eres mi sol, mi luna y todas mis estrellas. No puedo concebir la vida sin ti. Te amo. ğŸŒŸ"
        },
        {
            titulo: "Disculpa de CorazÃ³n",
            mensaje: "SÃ© que he cometido errores. Pero quiero que sepas que te amo y lamento profundamente. PerdÃ³name. ğŸ’”"
        }
    ],

    amistad: [
        {
            titulo: "Mejor Amigo",
            mensaje: "Gracias por estar siempre ahÃ­, por tus risas, por tu apoyo incondicional. Eres un amigo invaluable. Â¡Te quiero mucho! ğŸ‘¯"
        },
        {
            titulo: "Siempre Juntos",
            mensaje: "Los verdaderos amigos son difÃ­ciles de encontrar. Gracias por ser uno de ellos. Tu amistad es un tesoro. ğŸ¤"
        },
        {
            titulo: "Amigo Especial",
            mensaje: "Tenerte como amigo es una de las mejores cosas que me ha pasado en la vida. Gracias por todo. ğŸ«‚"
        },
        {
            titulo: "AgradÃ©zcele a un Amigo",
            mensaje: "QuerÃ­a agradecerte por ser tan especial. Tu amistad es importante para mÃ­. Gracias por estar siempre. ğŸ™"
        },
        {
            titulo: "Apoyo en Momentos DifÃ­ciles",
            mensaje: "SÃ© que estÃ¡s pasando por un momento difÃ­cil. Quiero que sepas que estoy aquÃ­ para ti. Cuenta conmigo siempre. ğŸ’ª"
        },
        {
            titulo: "Siempre Contigo",
            mensaje: "No importa lo que pase, siempre estarÃ© aquÃ­ para ti. Eres un amigo increÃ­ble y valioso. Gracias. ğŸ¤—"
        },
        {
            titulo: "CelebraciÃ³n de Amistad",
            mensaje: "Hoy celebramos nuestra amistad. Gracias por todos los buenos momentos y por ser quien eres. Â¡Te quiero mucho! ğŸ‰"
        },
        {
            titulo: "Amigo de CorazÃ³n",
            mensaje: "Los verdaderos amigos no cuentan los dÃ­as. Gracias por ser mi amigo de corazÃ³n. Valioso eres para mÃ­. ğŸ’™"
        }
    ],

    familia: [
        {
            titulo: "Para MamÃ¡",
            mensaje: "MamÃ¡, gracias por tanto amor, por tu dedicaciÃ³n y por ser el mejor ejemplo. Te amo con todo mi corazÃ³n. ğŸ‘©"
        },
        {
            titulo: "Para PapÃ¡",
            mensaje: "PapÃ¡, eres mi hÃ©roe, mi guÃ­a y mi mejor amigo. Gracias por todo lo que has hecho por mÃ­. Con cariÃ±o. ğŸ‘¨"
        },
        {
            titulo: "DÃ­a de la Madre",
            mensaje: "MamÃ¡, eres la mujer mÃ¡s fuerte y amorosa que conozco. Gracias por ser mi apoyo incondicional. Te amo. ğŸ’"
        },
        {
            titulo: "DÃ­a del Padre",
            mensaje: "PapÃ¡, gracias por tus enseÃ±anzas, tu amor y tu ejemplo. Eres el mejor padre del mundo. Te amo. ğŸ‘”"
        },
        {
            titulo: "Felicitaciones GraduaciÃ³n",
            mensaje: "Â¡Felicidades por tu graduaciÃ³n! Todo tu esfuerzo ha valido la pena. Estamos orgullosos de ti. Â¡Ã‰xitos! ğŸ“"
        },
        {
            titulo: "Baby Shower",
            mensaje: "Felicitaciones por esta hermosa noticia. Que el bebÃ© llegue con salud y llene su hogar de alegrÃ­a. ğŸ‘¶"
        },
        {
            titulo: "Bienvenida BebÃ©",
            mensaje: "Bienvenido/a a este mundo. Que seas feliz y que traigas mucha alegrÃ­a a tu familia. Â¡Felicidades! ğŸŒŸ"
        },
        {
            titulo: "DÃ­a de la Mujer",
            mensaje: "Gracias por ser tan especial. Celebra con orgullo todo lo que eres. Â¡Feliz DÃ­a de la Mujer! ğŸ’ƒ"
        },
        {
            titulo: "Para Mi Hermana",
            mensaje: "Hermana, gracias por ser mi compaÃ±era de vida. Te amo y te admiro. Eres especial. ğŸ’•"
        },
        {
            titulo: "Para Mi Hermano",
            mensaje: "Hermano, eres el mejor. Gracias por estar siempre y por ser quien eres. Te quiero mucho. ğŸ’™"
        }
    ],

    especiales: [
        {
            titulo: "Feliz Navidad",
            mensaje: "Que esta Navidad traiga paz, amor y muchas bendiciones a tu hogar. Â¡Feliz Navidad! ğŸ„"
        },
        {
            titulo: "PrÃ³ximo Matrimonio",
            mensaje: "Felicitaciones en este nuevo paso juntos. Que este dÃ­a sea solo el inicio de una hermosa historia llena de amor. ğŸ’"
        },
        {
            titulo: "Feliz AÃ±o Nuevo",
            mensaje: "Que este nuevo aÃ±o traiga bendiciones, Ã©xitos y momentos inolvidables. Â¡Feliz AÃ±o Nuevo! ğŸŠ"
        },
        {
            titulo: "DÃ­a de AcciÃ³n de Gracias",
            mensaje: "Hoy damos gracias por tener personas como tÃº en nuestras vidas. Â¡Feliz DÃ­a de AcciÃ³n de Gracias! ğŸ¦ƒ"
        },
        {
            titulo: "Bienvenida Casa Nueva",
            mensaje: "Felicitaciones por tu nuevo hogar. Que sea el lugar donde se construyan hermosos recuerdos y mucha felicidad. ğŸ "
        },
        {
            titulo: "Nuevo Trabajo",
            mensaje: "Felicidades por tu nuevo trabajo. Que sea el inicio de grandes logros y Ã©xitos profesionales. ğŸ’¼"
        },
        {
            titulo: "RecuperaciÃ³n RÃ¡pida",
            mensaje: "Esperamos tu pronta recuperaciÃ³n. Descansa y cuÃ­date. Estamos pensando en ti. Â¡Ãnimo! ğŸ’ª"
        },
        {
            titulo: "DÃ­a Especial",
            mensaje: "Sabemos que hoy es un dÃ­a especial para ti. Esperamos que lo celebres rodeado de las personas que amas. Â¡Felicidades! ğŸ‰"
        },
        {
            titulo: "Logro Alcanzado",
            mensaje: "Felicidades por tu logro. Sabemos que has trabajado duro para alcanzarlo. Â¡Sigue asÃ­! ğŸŒŸ"
        },
        {
            titulo: "MotivaciÃ³n",
            mensaje: "Sabemos que puedes lograrlo. Tienes toda nuestra confianza y apoyo. Â¡Vamos, tÃº puedes! ğŸ’ª"
        }
    ]
};

// FunciÃ³n para obtener todos los mensajes mezclados
function getAllMessages() {
    return [
        ...mensajesTarjetas.cumpleanos,
        ...mensajesTarjetas.amor,
        ...mensajesTarjetas.amistad,
        ...mensajesTarjetas.familia,
        ...mensajesTarjetas.especiales
    ];
}

// Variables globales para paginaciÃ³n
let mensajesActuales = [];
let paginaActual = 1;
let mensajesPorPagina = 10;

// FunciÃ³n para filtrar y mostrar mensajes
function filtrarMensajes(ocasion) {
    const contenedor = document.querySelector('.mensajes-grid');
    const paginacionContainer = document.getElementById('mensajesPagination');
    
    mensajesActuales = ocasion === 'todas' ? getAllMessages() : mensajesTarjetas[ocasion];
    paginaActual = 1; // Resetear a la primera pÃ¡gina
    
    if (!contenedor) {
        console.error('Contenedor de mensajes no encontrado');
        return;
    }

    if (!mensajesActuales || mensajesActuales.length === 0) {
        contenedor.innerHTML = '<p style="text-align: center; grid-column: 1/-1; color: var(--text-color);">No hay mensajes disponibles para esta categorÃ­a.</p>';
        paginacionContainer.innerHTML = '';
        return;
    }

    mostrarMensajesPagina();
    mostrarPaginacion();
}

// FunciÃ³n para mostrar mensajes de la pÃ¡gina actual
function mostrarMensajesPagina() {
    const contenedor = document.querySelector('.mensajes-grid');
    const inicio = (paginaActual - 1) * mensajesPorPagina;
    const fin = inicio + mensajesPorPagina;
    const mensajesPagina = mensajesActuales.slice(inicio, fin);
    
    contenedor.innerHTML = mensajesPagina.map((msg, index) => `
        <div class="mensaje-card">
            <h3 class="mensaje-titulo">${msg.titulo}</h3>
            <p class="mensaje-texto">${msg.mensaje}</p>
            <div class="mensaje-acciones">
                <button class="btn-copiar" onclick="copiarMensaje('${msg.titulo.replace(/'/g, "\\'")}', '${msg.mensaje.replace(/'/g, "\\'")}', ${inicio + index})">
                    ğŸ“‹ Copiar
                </button>
            </div>
        </div>
    `).join('');
}

// FunciÃ³n para mostrar controles de paginaciÃ³n
function mostrarPaginacion() {
    const paginacionContainer = document.getElementById('mensajesPagination');
    const totalPaginas = Math.ceil(mensajesActuales.length / mensajesPorPagina);
    
    if (totalPaginas <= 1) {
        paginacionContainer.innerHTML = '';
        return;
    }
    
    paginacionContainer.innerHTML = '';
    
    // ConfiguraciÃ³n para mostrar 5 pÃ¡ginas en escritorio y 3 en mÃ³vil
    const isMobile = window.innerWidth <= 768;
    const maxVisiblePages = isMobile ? 3 : 5;
    let startPage = Math.max(1, paginaActual - Math.floor(maxVisiblePages / 2));
    let endPage = Math.min(totalPaginas, startPage + maxVisiblePages - 1);
    
    // Ajustar startPage si estamos cerca del final
    if (endPage - startPage < maxVisiblePages - 1) {
        startPage = Math.max(1, endPage - maxVisiblePages + 1);
    }

    // BotÃ³n "Primera pÃ¡gina" si no estamos en la primera
    if (paginaActual > 1) {
        const firstButton = document.createElement('button');
        firstButton.textContent = 'Â«';
        firstButton.title = 'Primera pÃ¡gina';
        firstButton.addEventListener('click', () => cambiarPagina(1));
        paginacionContainer.appendChild(firstButton);
    }

    // BotÃ³n "Anterior" si no estamos en la primera pÃ¡gina
    if (paginaActual > 1) {
        const prevButton = document.createElement('button');
        prevButton.textContent = 'â€¹';
        prevButton.title = 'PÃ¡gina anterior';
        prevButton.addEventListener('click', () => cambiarPagina(paginaActual - 1));
        paginacionContainer.appendChild(prevButton);
    }

    // Botones de pÃ¡ginas
    for (let i = startPage; i <= endPage; i++) {
        const pageButton = document.createElement('button');
        pageButton.textContent = i;
        if (i === paginaActual) {
            pageButton.classList.add('active');
        }
        pageButton.addEventListener('click', () => cambiarPagina(i));
        paginacionContainer.appendChild(pageButton);
    }

    // BotÃ³n "Siguiente" si no estamos en la Ãºltima pÃ¡gina
    if (paginaActual < totalPaginas) {
        const nextButton = document.createElement('button');
        nextButton.textContent = 'â€º';
        nextButton.title = 'PÃ¡gina siguiente';
        nextButton.addEventListener('click', () => cambiarPagina(paginaActual + 1));
        paginacionContainer.appendChild(nextButton);
    }

    // BotÃ³n "Ãšltima pÃ¡gina" si no estamos en la Ãºltima
    if (paginaActual < totalPaginas) {
        const lastButton = document.createElement('button');
        lastButton.textContent = 'Â»';
        lastButton.title = 'Ãšltima pÃ¡gina';
        lastButton.addEventListener('click', () => cambiarPagina(totalPaginas));
        paginacionContainer.appendChild(lastButton);
    }
}

// FunciÃ³n para cambiar de pÃ¡gina
function cambiarPagina(nuevaPagina) {
    const totalPaginas = Math.ceil(mensajesActuales.length / mensajesPorPagina);
    
    if (nuevaPagina >= 1 && nuevaPagina <= totalPaginas) {
        paginaActual = nuevaPagina;
        mostrarMensajesPagina();
        mostrarPaginacion();
        
        // Scroll suave hacia la secciÃ³n de mensajes
        document.getElementById('mensajes-tarjetas').scrollIntoView({ 
            behavior: 'smooth', 
            block: 'start' 
        });
    }
}

// FunciÃ³n para copiar mensaje al portapapeles
function copiarMensaje(titulo, mensaje, index) {
    // Crear el texto completo con el tÃ­tulo en negrita
    const textoCompleto = `${titulo}\n\n${mensaje}`;
    
    // Crear un elemento temporal para copiar el texto
    const tempElement = document.createElement('textarea');
    tempElement.value = textoCompleto;
    tempElement.style.position = 'fixed';
    tempElement.style.opacity = '0';
    document.body.appendChild(tempElement);
    tempElement.select();
    
    try {
        document.execCommand('copy');
        showCopiedBanner();
    } catch (err) {
        console.error('Error al copiar:', err);
    } finally {
        document.body.removeChild(tempElement);
    }
}

// FunciÃ³n para mostrar banner de "copiado"
function showCopiedBanner() {
    const banner = document.getElementById('copiarBanner');
    if (banner) {
        banner.style.display = 'block';
        setTimeout(() => {
            banner.style.display = 'none';
        }, 3000);
    }
}

// Inicializar sistema de mensajes cuando el DOM estÃ© listo
document.addEventListener('DOMContentLoaded', function() {
    // Cargar mensajes de todas las categorÃ­as por defecto
    filtrarMensajes('todas');

    // Inicializar Select2 para todas las resoluciones
    const select2Ocasiones = $('#ocasiones-select2');
    if (select2Ocasiones.length) {
        select2Ocasiones.select2({
            placeholder: 'Seleccionar ocasiones...',
            allowClear: true,
            width: '100%'
        });

        select2Ocasiones.on('change', function() {
            const valores = $(this).val();
            // Si no hay selecciones, mostrar todas las categorÃ­as
            if (!valores || valores.length === 0) {
                filtrarMensajes('todas');
            } else {
                // Filtrar por la primera categorÃ­a seleccionada
                filtrarMensajes(valores[0]);
            }
        });
    }

    // Redibujar paginaciÃ³n cuando cambie el tamaÃ±o de la ventana
    window.addEventListener('resize', function() {
        if (mensajesActuales.length > 0) {
            mostrarPaginacion();
        }
    });

    console.log('âœ… Sistema de mensajes para tarjetas inicializado');
});

